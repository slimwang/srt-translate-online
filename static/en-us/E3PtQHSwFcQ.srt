1
00:00:00,390 --> 00:00:07,550
Let's suppose that AS200 originates a prefix and that the path that result from

2
00:00:07,550 --> 00:00:10,110
the original BGP routing are shown in

3
00:00:10,110 --> 00:00:14,610
green. Let's now suppose that AS100 seeks to

4
00:00:14,610 --> 00:00:19,650
become a man in the middle. If the original prefix being advertised was P, AS

5
00:00:19,650 --> 00:00:25,970
100 could also advertise the prefix P, but we want to make sure that AS

6
00:00:25,970 --> 00:00:31,230
100 maintains a path back to AS 200. Now that path already exists,

7
00:00:31,230 --> 00:00:36,410
it's right here. So what we want to do is make sure that neither AS 10

8
00:00:36,410 --> 00:00:41,200
nor as 20 except this hijacked route. The way that we can do

9
00:00:41,200 --> 00:00:46,288
that is through a technique called as-path poisoning.

10
00:00:46,288 --> 00:00:51,960
So, if AS 100 advertises a route that includes

11
00:00:51,960 --> 00:00:59,060
AS 10 and AS 20 Both of these AS's will drop the announcement because they will

12
00:00:59,060 --> 00:01:01,660
think they've already heard the announcement and don't

13
00:01:01,660 --> 00:01:03,700
want to form a loop. On the other hand,

14
00:01:04,849 --> 00:01:10,840
the other AS's on the internet, in other words, every other AS that's not on the

15
00:01:10,840 --> 00:01:17,760
path back from 100 to 200 will switch and now all of the traffic from other AS's

16
00:01:17,760 --> 00:01:23,170
enroute to AS 200 will traverse the attacker AS100. Now

17
00:01:23,170 --> 00:01:27,760
a trace route might look awfully funny taking this circuitous route, but

18
00:01:27,760 --> 00:01:32,320
actually the attacker can hide its presence even if the sender is running a

19
00:01:32,320 --> 00:01:37,680
trace route. Recall that a trace route simply consists of

20
00:01:37,680 --> 00:01:43,220
ICMP time exceeded messages. That result when a particular packet

21
00:01:43,220 --> 00:01:46,900
reaches a TTL of 0. Now typically each

22
00:01:46,900 --> 00:01:49,500
router along a path will decrement the TTL at

23
00:01:49,500 --> 00:01:51,180
each hop. But if the routers in the

24
00:01:51,180 --> 00:01:54,730
attacker's network never decrement the TTL, then no time

25
00:01:54,730 --> 00:01:58,920
exceeded messages would be generated by routers in

26
00:01:58,920 --> 00:02:02,320
AS 100. Therefore the traceroute would never show AS

27
00:02:02,320 --> 00:02:04,920
100 on the path at all. So now that

28
00:02:04,920 --> 00:02:08,580
we've talked about the importance of origin authentication and

29
00:02:08,580 --> 00:02:12,100
attacks against it, lets talk a little bit about session authentication.
